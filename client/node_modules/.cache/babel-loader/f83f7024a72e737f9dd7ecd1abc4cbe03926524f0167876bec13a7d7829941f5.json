{"ast":null,"code":"import React from 'react';\nimport { useSyncExternalStore } from \"./useSyncExternalStore.mjs\";\nimport { notifyManager } from \"../core/index.mjs\";\nimport { useQueryErrorResetBoundary } from \"./QueryErrorResetBoundary.mjs\";\nimport { useQueryClient } from \"./QueryClientProvider.mjs\";\nimport { shouldThrowError } from \"./utils.mjs\";\nimport { useIsRestoring } from \"./isRestoring.mjs\";\nexport function useBaseQuery(options, Observer) {\n  const queryClient = useQueryClient({\n    context: options.context\n  });\n  const isRestoring = useIsRestoring();\n  const errorResetBoundary = useQueryErrorResetBoundary();\n  const defaultedOptions = queryClient.defaultQueryOptions(options); // Make sure results are optimistically set in fetching state before subscribing or updating options\n\n  defaultedOptions._optimisticResults = isRestoring ? 'isRestoring' : 'optimistic'; // Include callbacks in batch renders\n\n  if (defaultedOptions.onError) {\n    defaultedOptions.onError = notifyManager.batchCalls(defaultedOptions.onError);\n  }\n  if (defaultedOptions.onSuccess) {\n    defaultedOptions.onSuccess = notifyManager.batchCalls(defaultedOptions.onSuccess);\n  }\n  if (defaultedOptions.onSettled) {\n    defaultedOptions.onSettled = notifyManager.batchCalls(defaultedOptions.onSettled);\n  }\n  if (defaultedOptions.suspense) {\n    // Always set stale time when using suspense to prevent\n    // fetching again when directly mounting after suspending\n    if (typeof defaultedOptions.staleTime !== 'number') {\n      defaultedOptions.staleTime = 1000;\n    }\n  }\n  if (defaultedOptions.suspense || defaultedOptions.useErrorBoundary) {\n    // Prevent retrying failed query if the error boundary has not been reset yet\n    if (!errorResetBoundary.isReset()) {\n      defaultedOptions.retryOnMount = false;\n    }\n  }\n  const [observer] = React.useState(() => new Observer(queryClient, defaultedOptions));\n  const result = observer.getOptimisticResult(defaultedOptions);\n  useSyncExternalStore(React.useCallback(onStoreChange => isRestoring ? () => undefined : observer.subscribe(notifyManager.batchCalls(onStoreChange)), [observer, isRestoring]), () => observer.getCurrentResult(), () => observer.getCurrentResult());\n  React.useEffect(() => {\n    errorResetBoundary.clearReset();\n  }, [errorResetBoundary]);\n  React.useEffect(() => {\n    // Do not notify on updates because of changes in the options because\n    // these changes should already be reflected in the optimistic result.\n    observer.setOptions(defaultedOptions, {\n      listeners: false\n    });\n  }, [defaultedOptions, observer]); // Handle suspense\n\n  if (defaultedOptions.suspense && result.isLoading && result.isFetching && !isRestoring) {\n    throw observer.fetchOptimistic(defaultedOptions).then(({\n      data\n    }) => {\n      defaultedOptions.onSuccess == null ? void 0 : defaultedOptions.onSuccess(data);\n      defaultedOptions.onSettled == null ? void 0 : defaultedOptions.onSettled(data, null);\n    }).catch(error => {\n      errorResetBoundary.clearReset();\n      defaultedOptions.onError == null ? void 0 : defaultedOptions.onError(error);\n      defaultedOptions.onSettled == null ? void 0 : defaultedOptions.onSettled(undefined, error);\n    });\n  } // Handle error boundary\n\n  if (result.isError && !errorResetBoundary.isReset() && !result.isFetching && shouldThrowError(defaultedOptions.useErrorBoundary, [result.error, observer.getCurrentQuery()])) {\n    throw result.error;\n  } // Handle result property usage tracking\n\n  return !defaultedOptions.notifyOnChangeProps ? observer.trackResult(result) : result;\n}","map":{"version":3,"names":["React","useSyncExternalStore","notifyManager","useQueryErrorResetBoundary","useQueryClient","shouldThrowError","useIsRestoring","useBaseQuery","options","Observer","queryClient","context","isRestoring","errorResetBoundary","defaultedOptions","defaultQueryOptions","_optimisticResults","onError","batchCalls","onSuccess","onSettled","suspense","staleTime","useErrorBoundary","isReset","retryOnMount","observer","useState","result","getOptimisticResult","useCallback","onStoreChange","undefined","subscribe","getCurrentResult","useEffect","clearReset","setOptions","listeners","isLoading","isFetching","fetchOptimistic","then","data","catch","error","isError","getCurrentQuery","notifyOnChangeProps","trackResult"],"sources":["C:/Users/chich/Project/client/node_modules/react-query/lib/reactjs/useBaseQuery.mjs"],"sourcesContent":["import React from 'react';\nimport { useSyncExternalStore } from \"./useSyncExternalStore.mjs\";\nimport { notifyManager } from \"../core/index.mjs\";\nimport { useQueryErrorResetBoundary } from \"./QueryErrorResetBoundary.mjs\";\nimport { useQueryClient } from \"./QueryClientProvider.mjs\";\nimport { shouldThrowError } from \"./utils.mjs\";\nimport { useIsRestoring } from \"./isRestoring.mjs\";\nexport function useBaseQuery(options, Observer) {\n  const queryClient = useQueryClient({\n    context: options.context\n  });\n  const isRestoring = useIsRestoring();\n  const errorResetBoundary = useQueryErrorResetBoundary();\n  const defaultedOptions = queryClient.defaultQueryOptions(options); // Make sure results are optimistically set in fetching state before subscribing or updating options\n\n  defaultedOptions._optimisticResults = isRestoring ? 'isRestoring' : 'optimistic'; // Include callbacks in batch renders\n\n  if (defaultedOptions.onError) {\n    defaultedOptions.onError = notifyManager.batchCalls(defaultedOptions.onError);\n  }\n\n  if (defaultedOptions.onSuccess) {\n    defaultedOptions.onSuccess = notifyManager.batchCalls(defaultedOptions.onSuccess);\n  }\n\n  if (defaultedOptions.onSettled) {\n    defaultedOptions.onSettled = notifyManager.batchCalls(defaultedOptions.onSettled);\n  }\n\n  if (defaultedOptions.suspense) {\n    // Always set stale time when using suspense to prevent\n    // fetching again when directly mounting after suspending\n    if (typeof defaultedOptions.staleTime !== 'number') {\n      defaultedOptions.staleTime = 1000;\n    }\n  }\n\n  if (defaultedOptions.suspense || defaultedOptions.useErrorBoundary) {\n    // Prevent retrying failed query if the error boundary has not been reset yet\n    if (!errorResetBoundary.isReset()) {\n      defaultedOptions.retryOnMount = false;\n    }\n  }\n\n  const [observer] = React.useState(() => new Observer(queryClient, defaultedOptions));\n  const result = observer.getOptimisticResult(defaultedOptions);\n  useSyncExternalStore(React.useCallback(onStoreChange => isRestoring ? () => undefined : observer.subscribe(notifyManager.batchCalls(onStoreChange)), [observer, isRestoring]), () => observer.getCurrentResult(), () => observer.getCurrentResult());\n  React.useEffect(() => {\n    errorResetBoundary.clearReset();\n  }, [errorResetBoundary]);\n  React.useEffect(() => {\n    // Do not notify on updates because of changes in the options because\n    // these changes should already be reflected in the optimistic result.\n    observer.setOptions(defaultedOptions, {\n      listeners: false\n    });\n  }, [defaultedOptions, observer]); // Handle suspense\n\n  if (defaultedOptions.suspense && result.isLoading && result.isFetching && !isRestoring) {\n    throw observer.fetchOptimistic(defaultedOptions).then(({\n      data\n    }) => {\n      defaultedOptions.onSuccess == null ? void 0 : defaultedOptions.onSuccess(data);\n      defaultedOptions.onSettled == null ? void 0 : defaultedOptions.onSettled(data, null);\n    }).catch(error => {\n      errorResetBoundary.clearReset();\n      defaultedOptions.onError == null ? void 0 : defaultedOptions.onError(error);\n      defaultedOptions.onSettled == null ? void 0 : defaultedOptions.onSettled(undefined, error);\n    });\n  } // Handle error boundary\n\n\n  if (result.isError && !errorResetBoundary.isReset() && !result.isFetching && shouldThrowError(defaultedOptions.useErrorBoundary, [result.error, observer.getCurrentQuery()])) {\n    throw result.error;\n  } // Handle result property usage tracking\n\n\n  return !defaultedOptions.notifyOnChangeProps ? observer.trackResult(result) : result;\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}